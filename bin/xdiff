#!/usr/bin/env bash
if [ $# -eq 2 ]; then
    OLD=$1
    NEW=$2
else
    OLD=$2
    NEW=$3
fi
diffcmd=""
if [ -n "$XDIFF" ]; then
    diffcmd="$XDIFF"
elif [ $(command -v ksdiff) ]; then
        diffcmd=ksdiff
elif [ $(command -v mvim) ]; then
    diffcmd=mvim
elif [ $(command -v vimdiff) ]; then
    diffcmd=vimdiff
fi
echo "Using diff program: $diffcmd"

# bbdiff --wait --resume "$NEW" "$OLD"
case "$diffcmd" in
    ksdiff)
        if [ $# -eq 2 ]; then
            ksdiff "$OLD" "$NEW"
        else
            ksdiff --partial-changeset --relative-path "$1" -- "$OLD" "$NEW"
        fi
        ;;

    mvim)
        mvim -d -f "$OLD" "$NEW"
        ;;

    vimdiff)
        vimdiff "$OLD" "$NEW"
        ;;

    *)
        diff "$OLD" "$NEW"
        ;;
esac
